window._bd_share_main.F.module("view/select_view",function(e,t,a){var n,s,i,o,r=e("base/tangram").T,d=e("base/class").Class,l=(e("conf/const"),e("view/view_base")),c=function(e){var t="";return t=document.selection?document.selection.createRange().text:document.getSelection(),r.string(t.toString()).trim()},h="getSelection"in document?function(){document.getSelection().removeAllRanges(),o=""}:function(){document.selection.empty(),o=""};t.View=d.create(function(e){function t(e,t){var d=function(e,t){var a=e.pageY,s=e.pageX;a+=5,s-=18;var i=n.outerHeight(),o=r(window).scrollTop();(a+i>r("body").height()&&a+i>r(window).height()||a+i>o+r(window).height())&&(a=(a=e.pageY-i-5)<o?o:a);var d=t.bdPopupOffsetLeft,l=t.bdPopupOffsetTop;return(d||l)&&(a+=0|l,s+=0|d),{top:a,left:s}}(e,t);if(o.length<5)a.hide("less");else{r.each([n,s],function(e,a){a.css({top:d.top,left:d.left}).show(),t.bdText=c()});var l=i.find("a").length,h=r(i.find("a")).outerWidth(!0)*l+20,_=parseInt(n.css("max-width"));_&&h>_&&(h=_),n.width(h),n.find(".bdselect_share_head").width(h),s.width(h),s.height(n.height());var u=n.find(".bdselect_share_dialog_search");u.attr("href","http://www.baidu.com/s?wd="+t.bdText+"&tn=SE_hldp08010_vurs2xrp");var f=p(function(){b("http://s.share.baidu.com/select?"+r.ajax.param({log_type:"click",content:encodeURIComponent(t.bdText)}))},100);u.click(f),h<220?n.find(".bdselect_share_dialog_search_span").hide():n.find(".bdselect_share_dialog_search_span").show(),b("http://s.share.baidu.com/select?"+r.ajax.param({log_type:"show",content:encodeURIComponent(t.bdText)}))}}var a=this;a._container=null;var d=e.bdStyle||0,l="|16|24|32|".indexOf("|"+e.bdSize+"|")>-1?e.bdSize:16,_=!1;a._buttonType=0,a.render=function(){var t="bdSharePopup_selectshare"+ +new Date,o=['<iframe frameborder="0" id="'+t+'bg" class="bdselect_share_bg" style="display:none;"></iframe>'].join(""),c=['<div id="'+t+'box" style="display:none;" share-type="selectshare" class="bdselect_share_box">','<div class="selectshare-mod-triangle"><div class="triangle-border"></div><div class="triangle-inset"></div></div>','<div  class="bdselect_share_head" ><span>分享到</span>','<a href="http://www.baidu.com/s?wd='+e.bdText+'&tn=SE_hldp08010_vurs2xrp"',' class="bdselect_share_dialog_search" target="_blank">','<i class="bdselect_share_dialog_search_i"></i>','<span class="bdselect_share_dialog_search_span">百度一下</span></a>','<a class="bdselect_share_dialog_close"></a></div>','<div class="bdselect_share_content" >','<ul class="bdselect_share_list">','<div class="bdselect_share_partners"></div>','<a href="#" class="bds_more"  data-cmd="more"></a>',"</ul>","</div>","</div>"].join("");r("body").insertHTML("beforeEnd",o+c),a._container=n=r("#"+t+"box"),i=n.find(".bdselect_share_list").addClass("bdshare-button-style"+d+"-"+l),s=r("#"+t+"bg"),a._entities.push(n),r(".bdselect_share_dialog_close").click(a.hide)},a.hide=function(e){e||h(),s&&s.hide(),n&&n.hide()},a._init=function(){var t;t=e.bdContainerClass?r("."+e.bdContainerClass):r("body").children(),r("body").on("mouseup",function(s){t.each(function(t,i){i==s.target||r(i).contains(s.target)||!e.bdContainerClass&&s.target==document.body?setTimeout(function(){o=c(),function(){if(e.bdCustomStyle){var t=document.createElement("link");t.href=e.bdCustomStyle,t.rel="styleSheet",t.type="text/css",document.getElementsByTagName("head")[0].appendChild(t)}else window._bd_share_main.F.use("share_style"+d+"_"+l+".css")}(),a.show(s,e)},10):"block"==n.css("display")&&a.hide()})})},a.show=function(e,n){window._bd_share_main.F.use(["component/partners","share_popup.css","select_share.css"],function(s){a._partnerSort=s.partnerSort,_||(function(e,t){t.bdMini;var n=t.bdSelectMiniList||a._partnerSort.slice(0,4),s=[];r.each(n,function(e,t){s[e]='<a href="#" class="bds_'+t+'" data-cmd="'+t+'"></a>'}),i.find(".bdselect_share_partners").html(s.join(""))}(a._container,n),_=!0),t(e,n)})};var u,b=(u={},function(e){var t="bdsharelog__"+(new Date).getTime(),a=u[t]=new Image;a.onload=a.onerror=function(){u[t]=null},a.src=e+"&t="+(new Date).getTime(),a=null}),p=function(e,t,a){var n,s,i,o=null,r=0;a||(a={});var d=function(){r=!1===a.leading?0:new Date,o=null,i=e.apply(n,s),o||(n=s=null)};return function(){var l=new Date;!r&&!1===a.leading&&(r=l);var c=t-(l-r);return n=this,s=arguments,c<=0||c>t?(clearTimeout(o),o=null,r=l,i=e.apply(n,s),o||(n=s=null)):!o&&!1!==a.trailing&&(o=setTimeout(d,c)),i}};a._distory=function(){n.remove(),s.remove()}},l.ViewBase)});